function output=curvefitting(x,r,count)
% B/D = 0.25
p1 = zeros(4,5);
p1(1,:) = [0.4664 0.19 3.019 0.1864 -1];
p1(2,:) = [10.27 3.844 1.222 0.000778 0];
p1(3,:) = [0.08189 0.05012 10.81 0.8045 -0.0628];
p1(4,:) = [667.4 707.6 27.21 7.937 0];

% B/D = 0.5 
p2 = zeros(4,5);
p2(1,:) = [0.8853 1.31 5.75 1.27 -1];
p2(2,:) = [14.88 19.2 6.162 0.00735 0];
p2(3,:) = [0.0779 0.1054 4.155 0.8793 -0.1155];
p2(4,:) = [375 140.6 17.15 1.614 0];

% B/D = 0.75
p3 = zeros(4,5);
p3(1,:) = [1.1 4.351 9.118 4.187 -1];
p3(2,:) = [19.83 40.97 13.56 -0.009262 0];
p3(3,:) = [.08133 6.934 83.07 43.37 -0.1555];
p3(4,:) = [869.3 1828 34.56 20.76 0];

% B/D = 1
p4 = zeros(4,5);
p4(1,:) = [1.53 43.16 52.71 41.18 -1];
p4(2,:) = [23.48 57.46 19.84 -0.1203 0];
p4(3,:) = [0.1135 0.4251 3.424 2.218 -0.184];
p4(4,:) = [1005 3470 40.35 40.07 0];

% B/D = 1.25
p5 = zeros(4,5);
p5(1,:) = [1.041 -0.5959 0.3678 -0.5426 -1];
p5(2,:) = [25.68 65.05 23.74 -0.4406 0];
p5(3,:) = [0.1314 0.3167 1.893 1.562 -0.2];
p5(4,:) = [1109 5726 46.26 67.37 0];

% B/D = 1.5
p6 = zeros(4,5);
p6(1,:) = [1.089 0.2073 0.8741 0.2846 -1];
p6(2,:) = [27.04 67.39 26.09 -0.9426 0];
p6(3,:) = [0.1158 0.5082 2.056 2.44 -0.207];
p6(4,:) = [1193 8501 52.39 101.6 0];

if r<0.5
    P1=p1;
    P2=p2;
    a=r-0.25;
end

if r>=0.5 && r<0.75
    P1=p2;
    P2=p3;
    a=r-0.5;
end

if r>=0.75 && r<1
    P1=p3;
    P2=p4;
    a=r-0.75;
end

if r>=1 && r<1.25
    P1=p4;
    P2=p5;
    a=r-1;
end

if r>=1.25
    P1=p5;
    P2=p6;
    a=r-1.25;
end

out1=((P1(count,1)*x + P1(count,2)) / (x^2 + P1(count,3)*x + P1(count,4))+P1(count,5))*sign(P1(count,5)+0.001);
out2=((P2(count,1)*x + P2(count,2)) / (x^2 + P2(count,3)*x + P2(count,4))+P2(count,5))*sign(P2(count,5)+0.001);

output = out1*(1-4*a)+out2*4*a;
end
